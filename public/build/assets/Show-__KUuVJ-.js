import{r as p,a as g,j as e,H as b,L as o,c as u}from"./app-ixndsVVo.js";import{A as k}from"./AdminLayout-DEfAXfXn.js";import{D as m}from"./DangerButton-CvQuZ9x8.js";import{C as f}from"./ConfirmationModal-dBfYQuSA.js";function y({auditTrail:a,availableEvents:s={},auth:n}){const t={...a,created_at:a?.created_at||new Date().toISOString(),created_at_human:a?.created_at_human||"Waktu tidak tersedia",event_color:a?.event_color||"neutral",table_display_name:a?.table_display_name||"Tabel tidak diketahui",message:a?.message||"Aktivitas tidak diketahui",user:a?.user||null,old_values:a?.old_values||null,new_values:a?.new_values||null},[r,i]=p.useState({isOpen:!1,auditTrailId:null,auditTrailDescription:""}),{success:c,error:x}=g(),d=()=>{i({isOpen:!0,auditTrailId:t.id,auditTrailDescription:t.message})},l=()=>{i({isOpen:!1,auditTrailId:null,auditTrailDescription:""})},h=()=>{r.auditTrailId?u.delete(route("admin.audit-trail.cleanup"),{days:0,id:r.auditTrailId},{onSuccess:()=>{c("Log audit trail berhasil dihapus!"),l(),u.visit(route("admin.audit-trail.index"))},onError:()=>{x("Gagal menghapus log audit trail."),l()}}):l()};return e.jsxs(k,{title:"Detail Audit Trail",children:[e.jsx(b,{title:"Detail Audit Trail"}),e.jsx(f,{isOpen:r.isOpen,onClose:l,onConfirm:h,title:"Konfirmasi Penghapusan",message:`Apakah Anda yakin ingin menghapus log audit trail "${r.auditTrailDescription}"? Tindakan ini tidak dapat dibatalkan.`,confirmText:"Hapus Log",cancelText:"Batal"}),e.jsx("div",{className:"mx-auto px-1 lg:px-4 lg:pt-2",children:e.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-800 rounded-xl shadow-card overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-6 py-5 text-white flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Detail Audit Trail"}),e.jsx("p",{className:"text-primary-100 opacity-90 mt-1",children:"Informasi lengkap tentang aktivitas sistem"})]}),e.jsxs("div",{className:"hidden md:flex items-center space-x-3",children:[e.jsxs(o,{href:route("admin.audit-trail.index"),className:"inline-flex items-center justify-center px-4 py-2 bg-neutral-50/20 hover:bg-neutral-50/30 border border-neutral-50/30 rounded-lg text-white shadow-sm transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali"]}),n.user.permissions.includes("manage audit trail")&&e.jsxs(m,{onClick:d,className:"flex items-center px-4 py-2",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus"]})]})]}),e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"flex flex-col mb-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-3 bg-${t.event_color}-500`}),e.jsx("h1",{className:"text-2xl font-bold text-neutral-900 dark:text-white",children:s[t.event]||t.event})]}),e.jsx("p",{className:"text-lg text-neutral-600 dark:text-neutral-300",children:t.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-700/50 p-3 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 dark:text-white mb-5 border-b border-neutral-200 dark:border-neutral-600 pb-3",children:"Informasi Audit"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"ID Log"}),e.jsxs("p",{className:"text-lg font-medium text-neutral-900 dark:text-white",children:["#",t.id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Peristiwa"}),e.jsx("p",{className:"text-lg font-medium text-neutral-900 dark:text-white",children:s[t.event]||t.event})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Tabel"}),e.jsx("p",{className:"text-lg font-medium text-neutral-900 dark:text-white",children:t.table_display_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Pengguna"}),e.jsx("p",{className:"text-lg font-medium text-neutral-900 dark:text-white",children:t.user?t.user.name:"Sistem"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Waktu"}),e.jsx("p",{className:"text-lg font-medium text-neutral-900 dark:text-white",children:t.created_at?new Date(t.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Waktu tidak tersedia"})]})]})]}),(t.old_values||t.new_values)&&e.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-700/50 p-3 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 dark:text-white mb-5 border-b border-neutral-200 dark:border-neutral-600 pb-3",children:"Perubahan Data"}),e.jsxs("div",{className:"space-y-4",children:[t.old_values&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Nilai Lama"}),e.jsx("pre",{className:"text-sm text-neutral-900 dark:text-white bg-neutral-100 dark:bg-neutral-800 p-3 rounded-md overflow-auto",children:JSON.stringify(t.old_values,null,2)})]}),t.new_values&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-500 dark:text-neutral-400 mb-1",children:"Nilai Baru"}),e.jsx("pre",{className:"text-sm text-neutral-900 dark:text-white bg-neutral-100 dark:bg-neutral-800 p-3 rounded-md overflow-auto",children:JSON.stringify(t.new_values,null,2)})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-neutral-200 dark:border-neutral-700 flex flex-col space-y-3 md:hidden",children:[n.user.permissions.includes("manage audit trail")&&e.jsxs(m,{onClick:d,className:"inline-flex items-center justify-center w-full px-6 py-3",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus Log"]}),e.jsxs(o,{href:route("admin.audit-trail.index"),className:"inline-flex items-center justify-center w-full px-6 py-3 bg-neutral-50 dark:bg-neutral-700 border border-neutral-300 dark:border-neutral-600 rounded-xl text-neutral-700 dark:text-neutral-300 shadow-sm hover:bg-neutral-100 dark:hover:bg-neutral-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke Daftar"]})]})]})]})})]})}export{y as default};
