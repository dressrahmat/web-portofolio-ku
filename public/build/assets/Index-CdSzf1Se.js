import{b as ie,r,a as oe,c as k,j as e,L as z,H as ce}from"./app-celmFoJj.js";import{A as de}from"./AdminLayout-CQak30NM.js";import{C as ue,B as me,D as xe,P as he}from"./Pagination-DfjUgOA1.js";import{m as $,n as pe,g as O,c as q,o as ge,p as ke,q as fe,r as be,k as je,s as ve}from"./index-D1VkzDTA.js";import{C as G}from"./ConfirmationModal-BwDb4Q3d.js";import{P as X}from"./PrimaryButton-BFA6pVfg.js";import{r as ye}from"./index-CkDq_o70.js";import"./Checkbox-DECWA5eL.js";const we=({trigger:s,children:l,position:i="bottom-right"})=>{const[c,u]=r.useState({top:0,left:0,width:0}),m=r.useRef(null),[x,d]=r.useState(!1),I=()=>{if(m.current){const h=m.current.getBoundingClientRect();u({top:h.bottom+window.scrollY,left:h.left+window.scrollX,width:h.width})}},N=()=>{switch(i){case"bottom-left":return"origin-top-left left-0";case"bottom-right":return"origin-top-right right-0";default:return"origin-top-right right-0"}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:m,onClick:()=>{I(),d(!0)},children:s}),x&&ye.createPortal(e.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>d(!1),children:e.jsx("div",{className:`absolute mt-1 w-48 rounded-md shadow-lg bg-neutral-50 dark:bg-neutral-800 ring-1 ring-primary-500 ring-opacity-20 focus:outline-none ${N()}`,style:{top:c.top,left:i==="bottom-right"?"auto":c.left,right:i==="bottom-right"?window.innerWidth-c.left-c.width:"auto",zIndex:9999},onClick:h=>h.stopPropagation(),children:l})}),document.body)]})},Ne=({artikel:s,onView:l,onEdit:i,onDelete:c,hasEditPermission:u,hasDeletePermission:m})=>{const x=e.jsx("button",{className:"inline-flex justify-center w-full p-2 text-sm font-medium text-primary-600 dark:text-primary-400 bg-neutral-50 dark:bg-neutral-800 rounded-md hover:bg-primary-50 dark:hover:bg-neutral-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(ve,{className:"h-4 w-4","aria-hidden":"true"})});return e.jsx(we,{trigger:x,position:"bottom-right",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:l,className:"group flex items-center w-full px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-primary-50 dark:hover:bg-neutral-700 hover:text-primary-600 dark:hover:text-primary-400",children:[e.jsx(q,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Lihat Detail"]}),u&&e.jsxs("button",{onClick:i,className:"group flex items-center w-full px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-primary-50 dark:hover:bg-neutral-700 hover:text-primary-600 dark:hover:text-primary-400",children:[e.jsx(be,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Edit"]}),m&&e.jsxs("button",{onClick:c,className:"group flex items-center w-full px-4 py-2 text-sm text-error-600 dark:text-error-400 hover:bg-error-50 dark:hover:bg-error-900/30 hover:text-error-700 dark:hover:text-error-300",children:[e.jsx(je,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Hapus"]})]})})},Se=({status:s})=>{const l={draf:{label:"Draf",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"},terbit:{label:"Terbit",className:"bg-success-100 text-success-800 dark:bg-success-900/30 dark:text-success-300"},arsip:{label:"Arsip",className:"bg-neutral-100 text-neutral-800 dark:bg-neutral-700 dark:text-neutral-300"}},i=l[s]||l.draf;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.className}`,children:i.label})},Ce=(s=[])=>{const[l,i]=r.useState(()=>{try{const u=sessionStorage.getItem("selectedArtikel");return u?JSON.parse(u):s}catch{return s}});r.useEffect(()=>{sessionStorage.setItem("selectedArtikel",JSON.stringify(l))},[l]);const c=r.useCallback(()=>{sessionStorage.removeItem("selectedArtikel"),i([])},[]);return[l,i,c]};function Te({artikel:s,filters:l,semuaKategori:i,statusOptions:c}){const{props:u}=ie(),{auth:m}=u,x=u.flash||{},[d,I]=r.useState({isOpen:!1,artikelId:null,artikelJudul:""}),[N,h]=r.useState({isOpen:!1,count:0}),[n,f,E]=Ce([]),[T,S]=r.useState(!1),[C,L]=r.useState(l?.search||""),[A,R]=r.useState(l?.status||""),[D,F]=r.useState(l?.kategori||""),[M,K]=r.useState(l?.per_page||10),[p,H]=r.useState({key:l?.sort||"created_at",direction:l?.direction||"desc"}),{success:b,error:j}=oe(),v=t=>m.user&&m.user.permissions&&m.user.permissions.includes(t),g=r.useRef({search:l?.search||"",status:l?.status||"",kategori:l?.kategori||"",per_page:l?.per_page||10,sort:l?.sort||"created_at",direction:l?.direction||"desc"});r.useEffect(()=>{const t={search:C,status:A,kategori:D,per_page:M,sort:p.key,direction:p.direction};if(t.search!==g.current.search||t.status!==g.current.status||t.kategori!==g.current.kategori||t.per_page!==g.current.per_page||t.sort!==g.current.sort||t.direction!==g.current.direction){const o=setTimeout(()=>{k.get(route("admin.artikel.index"),{search:C,status:A,kategori:D,sort:p.key,direction:p.direction,per_page:M},{preserveState:!0,replace:!0,preserveScroll:!0,onFinish:()=>{g.current=t}})},500);return()=>clearTimeout(o)}},[C,A,D,M,p]),r.useEffect(()=>{if(s&&s.data&&n.length>0){const t=s.data.map(P=>P.id),a=t.every(P=>n.includes(P)),o=t.some(P=>n.includes(P));S(!!a)}else S(!1)},[s,n]);const U=r.useCallback(t=>{k.visit(route("admin.artikel.show",t.id))},[]),V=r.useCallback(()=>{if(s&&s.data){const t=s.data.map(a=>a.id);f(T?a=>a.filter(o=>!t.includes(o)):a=>[...new Set([...a,...t])])}},[T,s,f]),W=r.useCallback(t=>{f(a=>a.includes(t)?a.filter(o=>o!==t):[...a,t])},[f]),J=r.useCallback((t,a)=>{I({isOpen:!0,artikelId:t,artikelJudul:a})},[]),Y=r.useCallback(()=>{h({isOpen:!0,count:n.length})},[n.length]),_=r.useCallback(()=>{I({isOpen:!1,artikelId:null,artikelJudul:""})},[]),B=r.useCallback(()=>{h({isOpen:!1,count:0})},[]),Q=r.useCallback(()=>{d.artikelId?k.delete(route("admin.artikel.destroy",d.artikelId),{onSuccess:()=>{b("Artikel berhasil dihapus!"),_(),f(t=>t.filter(a=>a!==d.artikelId))},onError:t=>{const a=t?.message||"Gagal menghapus artikel.";j(a),_()}}):_()},[d.artikelId,d.artikelJudul,_,b,j,f]),Z=r.useCallback(()=>{n.length>0&&k.post(route("admin.artikel.bulk-destroy"),{ids:n},{onSuccess:()=>{b(`${n.length} artikel berhasil dihapus!`),E(),S(!1),B()},onError:t=>{const a=t?.message||"Gagal menghapus artikel yang dipilih.";j(a),B()}})},[n,B,b,j,E]),ee=r.useCallback(()=>{n.length>0&&k.post(route("admin.artikel.export"),{ids:n},{onSuccess:()=>{b("Ekspor artikel berhasil dimulai!")},onError:()=>{j("Gagal mengekspor artikel.")}})},[n,b,j]),y=r.useCallback(t=>{H(a=>{let o="asc";return a.key===t&&a.direction==="asc"&&(o="desc"),{key:t,direction:o}})},[]),te=r.useCallback(()=>{L(""),R(""),F(""),K(10),H({key:"created_at",direction:"desc"}),k.get(route("admin.artikel.index"),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{g.current={search:"",status:"",kategori:"",per_page:10,sort:"created_at",direction:"desc"}}})},[]),re=r.useCallback(t=>{K(t)},[]),w=r.useCallback(t=>p.key!==t?e.jsx($,{className:"ml-1 h-4 w-4 opacity-50"}):p.direction==="asc"?e.jsx($,{className:"ml-1 h-4 w-4"}):e.jsx(pe,{className:"ml-1 h-4 w-4"}),[p]),ae=r.useMemo(()=>[{key:"judul",label:"Judul Artikel",sortable:!0,onSort:()=>y("judul"),sortIcon:w("judul"),render:t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:e.jsx(O,{className:"h-5 w-5 text-primary-600 dark:text-primary-400"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white line-clamp-1",children:t.judul}),e.jsx("div",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:t.slug})]})]})},{key:"kategori",label:"Kategori",render:t=>e.jsx("div",{className:"text-sm text-neutral-900 dark:text-white",children:t.kategori&&t.kategori.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.kategori.slice(0,2).map(a=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-neutral-100 text-neutral-800 dark:bg-neutral-700 dark:text-neutral-300",children:a.nama},a.id)),t.kategori.length>2&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-neutral-100 text-neutral-800 dark:bg-neutral-700 dark:text-neutral-300",children:["+",t.kategori.length-2]})]}):e.jsx("span",{className:"text-xs text-neutral-400 dark:text-neutral-500",children:"Tidak ada kategori"})})},{key:"status",label:"Status",sortable:!0,onSort:()=>y("status"),sortIcon:w("status"),render:t=>e.jsx(Se,{status:t.status})},{key:"views",label:"Dilihat",sortable:!0,onSort:()=>y("jumlah_dilihat"),sortIcon:w("jumlah_dilihat"),render:t=>e.jsxs("div",{className:"flex items-center text-sm text-neutral-900 dark:text-white",children:[e.jsx(q,{className:"mr-1 h-4 w-4 text-neutral-400"}),t.jumlah_dilihat.toLocaleString()]})},{key:"published",label:"Diterbitkan",sortable:!0,onSort:()=>y("diterbitkan_pada"),sortIcon:w("diterbitkan_pada"),render:t=>e.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:t.diterbitkan_pada?new Date(t.diterbitkan_pada).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):e.jsx("span",{className:"text-xs text-neutral-400",children:"Belum diterbitkan"})})},{key:"created_at",label:"Dibuat",sortable:!0,onSort:()=>y("created_at"),sortIcon:w("created_at"),render:t=>e.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:new Date(t.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})})}],[y,w]),se=r.useMemo(()=>e.jsxs("div",{className:"flex flex-col items-center justify-center text-neutral-400 dark:text-neutral-500",children:[e.jsx(O,{className:"h-12 w-12 mb-3 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Belum ada artikel"}),e.jsx("p",{className:"mt-1 text-sm",children:"Mulai dengan membuat artikel baru"}),v("create artikel")&&e.jsx("div",{className:"mt-6",children:e.jsx(z,{href:route("admin.artikel.create"),children:e.jsxs(X,{className:"flex items-center bg-primary-600 hover:bg-primary-700 focus:ring-primary-500",children:[e.jsx(ge,{className:"mr-2 h-5 w-5"}),"Tambah Artikel Baru"]})})})]}),[]),le=r.useCallback(t=>e.jsx(Ne,{artikel:t,onView:()=>k.visit(route("admin.artikel.show",t.id)),onEdit:()=>k.visit(route("admin.artikel.edit",t.id)),onDelete:()=>J(t.id,t.judul),hasEditPermission:v("edit artikel"),hasDeletePermission:v("delete artikel")}),[J]),ne=r.useMemo(()=>v("create artikel")?e.jsx(z,{href:route("admin.artikel.create"),children:e.jsxs(X,{className:"flex items-center bg-primary-600 hover:bg-primary-700 focus:ring-primary-500",children:[e.jsx(O,{className:"mr-2 h-5 w-5"}),"Tambah Artikel"]})}):null,[]);return e.jsxs(de,{title:"Kelola Artikel",children:[e.jsx(ce,{title:"Kelola Artikel"}),e.jsx(G,{isOpen:d.isOpen,onClose:_,onConfirm:Q,title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus artikel "${d.artikelJudul}"? Aksi ini tidak dapat dibatalkan.`,confirmText:"Hapus Artikel",cancelText:"Batal"}),v("delete artikel")&&e.jsx(G,{isOpen:N.isOpen,onClose:B,onConfirm:Z,title:"Konfirmasi Hapus Massal",message:`Apakah Anda yakin ingin menghapus ${N.count} artikel yang dipilih? Aksi ini tidak dapat dibatalkan.`,confirmText:`Hapus ${N.count} Artikel`,cancelText:"Batal"}),e.jsxs(ue,{title:"Manajemen Artikel",description:"Kelola semua artikel pada website",createButton:ne,filters:e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Cari Artikel"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:C,onChange:t=>L(t.target.value),placeholder:"Cari judul atau konten...",className:"w-full px-4 py-2 pl-10 border border-neutral-300 dark:border-neutral-600 bg-white dark:bg-neutral-700 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:focus:ring-primary-400 dark:focus:border-primary-400 text-neutral-900 dark:text-white"}),e.jsx(ke,{className:"absolute left-3 top-2.5 h-5 w-5 text-neutral-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Status"}),e.jsxs("select",{value:A,onChange:t=>R(t.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-600 bg-white dark:bg-neutral-700 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:focus:ring-primary-400 dark:focus:border-primary-400 text-neutral-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Semua Status"}),c?.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Kategori"}),e.jsxs("select",{value:D,onChange:t=>F(t.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-600 bg-white dark:bg-neutral-700 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:focus:ring-primary-400 dark:focus:border-primary-400 text-neutral-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Semua Kategori"}),i?.map(t=>e.jsx("option",{value:t.id,children:t.nama},t.id))]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:M,onChange:t=>re(t.target.value),className:"px-3 py-1.5 border border-neutral-300 dark:border-neutral-600 bg-white dark:bg-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-white",children:[e.jsx("option",{value:"5",children:"5 per halaman"}),e.jsx("option",{value:"10",children:"10 per halaman"}),e.jsx("option",{value:"15",children:"15 per halaman"}),e.jsx("option",{value:"20",children:"20 per halaman"}),e.jsx("option",{value:"50",children:"50 per halaman"})]})}),(C||A||D)&&e.jsxs("button",{onClick:te,className:"inline-flex items-center px-3 py-1.5 text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-white",children:[e.jsx(fe,{className:"mr-1 h-4 w-4"}),"Hapus Filter"]})]})]}),children:[x.success&&e.jsx("div",{className:"mb-8 bg-success-50 dark:bg-success-900/30 border border-success-200 dark:border-success-800 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-success-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-success-800 dark:text-success-200",children:x.success})})]})}),x.error&&e.jsx("div",{className:"mb-8 bg-error-50 dark:bg-error-900/30 border border-error-200 dark:border-error-800 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-error-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-error-800 dark:text-error-200",children:x.error})})]})}),v("delete artikel")&&n.length>0&&e.jsx("div",{className:"mb-6",children:e.jsx(me,{selectedCount:n.length,onBulkDelete:Y,onBulkExport:ee,onClearSelected:E})}),e.jsx("div",{className:"mb-6",children:e.jsx(xe,{columns:ae,data:s?.data||[],selectedItems:n,onSelectItem:W,onSelectAll:V,selectAll:T,emptyState:se,rowActions:le,keyField:"id",onRowClick:U})}),s&&s.data&&s.data.length>0&&s.links&&s.links.length>3&&e.jsx(he,{data:s})]})]})}export{Te as default};
