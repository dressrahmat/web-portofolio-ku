import{b as ee,r,a as te,c as g,j as e,L as O,H as re}from"./app-celmFoJj.js";import{A as ae}from"./AdminLayout-CQak30NM.js";import{C as se,B as oe,D as ie,P as le}from"./Pagination-DfjUgOA1.js";import{F as ne}from"./FilterSection-COMNNuB3.js";import{C as F}from"./ConfirmationModal-BwDb4Q3d.js";import{P as R}from"./PrimaryButton-BFA6pVfg.js";import{m as T,n as ce,e as de,z as L,o as ue,c as me,r as he,k as ge,s as xe}from"./index-D1VkzDTA.js";import{r as pe}from"./index-CkDq_o70.js";import"./Checkbox-DECWA5eL.js";const fe=({trigger:s,children:i,position:d="bottom-right"})=>{const[c,u]=r.useState({top:0,left:0,width:0}),l=r.useRef(null),[x,p]=r.useState(!1),N=()=>{if(l.current){const n=l.current.getBoundingClientRect();u({top:n.bottom+window.scrollY,left:n.left+window.scrollX,width:n.width})}},o=()=>{switch(d){case"bottom-left":return"origin-top-left left-0";case"bottom-right":return"origin-top-right right-0";default:return"origin-top-right right-0"}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:l,onClick:()=>{N(),p(!0)},children:s}),x&&pe.createPortal(e.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>p(!1),children:e.jsx("div",{className:`absolute mt-1 w-48 rounded-md shadow-lg bg-neutral-50 dark:bg-neutral-800 ring-1 ring-primary-500 ring-opacity-20 focus:outline-none ${o()}`,style:{top:c.top,left:d==="bottom-right"?"auto":c.left,right:d==="bottom-right"?window.innerWidth-c.left-c.width:"auto",zIndex:9999},onClick:n=>n.stopPropagation(),children:i})}),document.body)]})},ke=({kategori:s,onView:i,onEdit:d,onDelete:c,hasEditPermission:u,hasDeletePermission:l})=>{const x=e.jsx("button",{className:"inline-flex justify-center w-full p-2 text-sm font-medium text-primary-600 dark:text-primary-400 bg-neutral-50 dark:bg-neutral-800 rounded-md hover:bg-primary-50 dark:hover:bg-neutral-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(xe,{className:"h-4 w-4","aria-hidden":"true"})});return e.jsx(fe,{trigger:x,position:"bottom-right",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:i,className:"group flex items-center w-full px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-primary-50 dark:hover:bg-neutral-700 hover:text-primary-600 dark:hover:text-primary-400",children:[e.jsx(me,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Lihat Detail"]}),u&&e.jsxs("button",{onClick:d,className:"group flex items-center w-full px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-primary-50 dark:hover:bg-neutral-700 hover:text-primary-600 dark:hover:text-primary-400",children:[e.jsx(he,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Edit"]}),l&&e.jsxs("button",{onClick:c,className:"group flex items-center w-full px-4 py-2 text-sm text-error-600 dark:text-error-400 hover:bg-error-50 dark:hover:bg-error-900/30 hover:text-error-700 dark:hover:text-error-300",children:[e.jsx(ge,{className:"mr-3 h-4 w-4","aria-hidden":"true"}),"Hapus"]})]})})},be=(s=[])=>{const[i,d]=r.useState(()=>{try{const u=sessionStorage.getItem("selectedKategori");return u?JSON.parse(u):s}catch{return s}});r.useEffect(()=>{sessionStorage.setItem("selectedKategori",JSON.stringify(i))},[i]);const c=r.useCallback(()=>{sessionStorage.removeItem("selectedKategori"),d([])},[]);return[i,d,c]};function Ke({kategories:s,filters:i}){const{props:d}=ee(),{auth:c}=d,u=d.flash||{},[l,x]=r.useState({isOpen:!1,kategoriId:null,kategoriNama:""}),[p,N]=r.useState({isOpen:!1,count:0}),[o,n,D]=be([]),[K,y]=r.useState(!1),[C,I]=r.useState(i?.search||""),[S,A]=r.useState(i?.per_page||5),[h,B]=r.useState({key:i?.sort||"created_at",direction:i?.direction||"desc"}),{success:f,error:k}=te(),b=t=>c.user&&c.user.permissions&&c.user.permissions.includes(t),j=r.useRef({search:i?.search||"",per_page:i?.per_page||5,sort:i?.sort||"created_at",direction:i?.direction||"desc"});r.useEffect(()=>{const t={search:C,per_page:S,sort:h.key,direction:h.direction};if(t.search!==j.current.search||t.per_page!==j.current.per_page||t.sort!==j.current.sort||t.direction!==j.current.direction){const m=setTimeout(()=>{g.get(route("admin.kategori.index"),{search:C,sort:h.key,direction:h.direction,per_page:S},{preserveState:!0,replace:!0,preserveScroll:!0,onFinish:()=>{j.current=t}})},500);return()=>clearTimeout(m)}},[C,S,h]),r.useEffect(()=>{if(s&&s.data&&o.length>0){const t=s.data.map(w=>w.id),a=t.every(w=>o.includes(w)),m=t.some(w=>o.includes(w));y(!!a)}else y(!1)},[s,o]);const z=r.useCallback(t=>{g.visit(route("admin.kategori.show",t.id))},[]),H=r.useCallback(()=>{if(s&&s.data){const t=s.data.map(a=>a.id);n(K?a=>a.filter(m=>!t.includes(m)):a=>[...new Set([...a,...t])])}},[K,s,n]),$=r.useCallback(t=>{n(a=>a.includes(t)?a.filter(m=>m!==t):[...a,t])},[n]),E=r.useCallback((t,a)=>{x({isOpen:!0,kategoriId:t,kategoriNama:a})},[]),G=r.useCallback(()=>{N({isOpen:!0,count:o.length})},[o.length]),v=r.useCallback(()=>{x({isOpen:!1,kategoriId:null,kategoriNama:""})},[]),P=r.useCallback(()=>{N({isOpen:!1,count:0})},[]),J=r.useCallback(()=>{l.kategoriId?g.delete(route("admin.kategori.destroy",l.kategoriId),{onSuccess:()=>{f("Kategori berhasil dihapus!"),v(),n(t=>t.filter(a=>a!==l.kategoriId))},onError:t=>{const a=t?.message||"Gagal menghapus kategori.";k(a),v()}}):v()},[l.kategoriId,l.kategoriNama,v,f,k,n]),U=r.useCallback(()=>{o.length>0&&g.post(route("admin.kategori.bulk-destroy"),{ids:o},{onSuccess:()=>{f(`${o.length} kategori berhasil dihapus!`),D(),y(!1),P()},onError:t=>{const a=t?.message||"Gagal menghapus kategori yang dipilih.";k(a),P()}})},[o,P,f,k,D]),V=r.useCallback(()=>{o.length>0&&g.post(route("admin.kategori.export"),{ids:o},{onSuccess:()=>{f("Ekspor kategori berhasil dimulai!")},onError:()=>{k("Gagal mengekspor kategori.")}})},[o,f,k]),M=r.useCallback(t=>{B(a=>{let m="asc";return a.key===t&&a.direction==="asc"&&(m="desc"),{key:t,direction:m}})},[]),W=r.useCallback(()=>{I(""),A(5),B({key:"created_at",direction:"desc"}),g.get(route("admin.kategori.index"),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{j.current={search:"",per_page:5,sort:"created_at",direction:"desc"}}})},[]),X=r.useCallback(t=>{A(t)},[]),_=r.useCallback(t=>h.key!==t?e.jsx(T,{className:"ml-1 h-4 w-4 opacity-50"}):h.direction==="asc"?e.jsx(T,{className:"ml-1 h-4 w-4"}):e.jsx(ce,{className:"ml-1 h-4 w-4"}),[h]),Y=r.useMemo(()=>[{key:"nama",label:"Nama Kategori",sortable:!0,onSort:()=>M("nama"),sortIcon:_("nama"),render:t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:e.jsx(de,{className:"h-5 w-5 text-primary-600 dark:text-primary-400"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:t.nama}),e.jsx("div",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:t.slug})]})]})},{key:"deskripsi",label:"Deskripsi",render:t=>e.jsx("div",{className:"text-sm text-neutral-900 dark:text-white line-clamp-2",children:t.deskripsi||"-"})},{key:"artikels_count",label:"Jumlah Artikel",render:t=>e.jsx("div",{className:"text-sm text-neutral-900 dark:text-white",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300",children:[t.artikels_count||0," Artikel"]})})},{key:"created_at",label:"Dibuat Pada",sortable:!0,onSort:()=>M("created_at"),sortIcon:_("created_at"),render:t=>e.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:new Date(t.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})})}],[M,_]),q=r.useMemo(()=>e.jsxs("div",{className:"flex flex-col items-center justify-center text-neutral-400 dark:text-neutral-500",children:[e.jsx(L,{className:"h-12 w-12 mb-3 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Belum ada kategori"}),e.jsx("p",{className:"mt-1 text-sm",children:"Mulai dengan membuat kategori baru"}),b("create kategori")&&e.jsx("div",{className:"mt-6",children:e.jsx(O,{href:route("admin.kategori.create"),children:e.jsxs(R,{className:"flex items-center bg-primary-600 hover:bg-primary-700 focus:ring-primary-500",children:[e.jsx(ue,{className:"mr-2 h-5 w-5"}),"Tambah Kategori Baru"]})})})]}),[]),Q=r.useCallback(t=>e.jsx(ke,{kategori:t,onView:()=>g.visit(route("admin.kategori.show",t.id)),onEdit:()=>g.visit(route("admin.kategori.edit",t.id)),onDelete:()=>E(t.id,t.nama),hasEditPermission:b("edit kategori"),hasDeletePermission:b("delete kategori")}),[E]),Z=r.useMemo(()=>b("create kategori")?e.jsx(O,{href:route("admin.kategori.create"),children:e.jsxs(R,{className:"flex items-center bg-primary-600 hover:bg-primary-700 focus:ring-primary-500",children:[e.jsx(L,{className:"mr-2 h-5 w-5"}),"Tambah Kategori"]})}):null,[]);return e.jsxs(ae,{title:"Kelola Kategori",children:[e.jsx(re,{title:"Kelola Kategori"}),e.jsx(F,{isOpen:l.isOpen,onClose:v,onConfirm:J,title:"Konfirmasi Hapus",message:`Apakah Anda yakin ingin menghapus kategori "${l.kategoriNama}"? Aksi ini tidak dapat dibatalkan.`,confirmText:"Hapus Kategori",cancelText:"Batal"}),b("delete kategori")&&e.jsx(F,{isOpen:p.isOpen,onClose:P,onConfirm:U,title:"Konfirmasi Hapus Massal",message:`Apakah Anda yakin ingin menghapus ${p.count} kategori yang dipilih? Aksi ini tidak dapat dibatalkan.`,confirmText:`Hapus ${p.count} Kategori`,cancelText:"Batal"}),e.jsxs(se,{title:"Manajemen Kategori",description:"Kelola semua kategori untuk mengelompokkan artikel",createButton:Z,filters:e.jsx("div",{className:"mb-6",children:e.jsx(ne,{searchTerm:C,onSearchChange:I,perPage:S,onPerPageChange:X,onClearFilters:W})}),children:[u.success&&e.jsx("div",{className:"mb-8 bg-success-50 dark:bg-success-900/30 border border-success-200 dark:border-success-800 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-success-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-success-800 dark:text-success-200",children:u.success})})]})}),u.error&&e.jsx("div",{className:"mb-8 bg-error-50 dark:bg-error-900/30 border border-error-200 dark:border-error-800 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-error-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-error-800 dark:text-error-200",children:u.error})})]})}),b("delete kategori")&&o.length>0&&e.jsx("div",{className:"mb-6",children:e.jsx(oe,{selectedCount:o.length,onBulkDelete:G,onBulkExport:V,onClearSelected:D})}),e.jsx("div",{className:"mb-6",children:e.jsx(ie,{columns:Y,data:s?.data||[],selectedItems:o,onSelectItem:$,onSelectAll:H,selectAll:K,emptyState:q,rowActions:Q,keyField:"id",onRowClick:z})}),s&&s.data&&s.data.length>0&&s.links&&s.links.length>3&&e.jsx(le,{data:s})]})]})}export{Ke as default};
